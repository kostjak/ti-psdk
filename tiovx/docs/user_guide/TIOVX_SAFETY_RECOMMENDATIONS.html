<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TIOVX User Guide: TIOVX Safety Recommendations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TIOVX User Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('TIOVX_SAFETY_RECOMMENDATIONS.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TIOVX Safety Recommendations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#TIOVX_SAFETY_INITIALIZATION">TIOVX Initialization in Safety Systems</a></li>
<li class="level1"><a href="#TIOVX_SAFETY_USAGE">TIOVX Usage Recommendations for Safety</a><ul><li class="level2"><a href="#TIOVX_SAFETY_USAGE_DELAY">Delay Object Support</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_USAGE_COMPOSITE_OBJECTS">Composite Object Pipelining Support</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_USAGE_MAP_COPY">Safety Implications of TIOVX Map and Copy API Implementation</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_USAGE_NESTED_NODE">Nested Node Safety Usage Information</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_USAGE_FURTHER_INFO">Further information</a></li>
</ul>
</li>
<li class="level1"><a href="#TIOVX_SAFETY_MEMORY_MANAGEMENT">TIOVX Memory Management for Safety</a><ul><li class="level2"><a href="#TIOVX_SAFETY_MEMORY_MANAGEMENT_APPLICATION">Requirements for Application Usage of OpenVX data objects</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_MEMORY_MANAGEMENT_OBJ_DESCRIPTOR_TABLE">Requirement for object descriptor table</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_MEMORY_MANAGEMENT_PHYS_ADDR">Note about Physical Addresses</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_EXTERNALLY_ALLOCATED_MEMORY">Requirements for Memory Allocated Outside of TIOVX Framework</a><ul><li class="level3"><a href="#TIOVX_SAFETY_EXTERNALLY_ALLOCATED_MEMORY_IMAGE">Requirements of vxCreateImageFromHandle and vxSwapImageHandle</a></li>
<li class="level3"><a href="#TIOVX_SAFETY_EXTERNALLY_ALLOCATED_MEMORY_IMPORT">Requirements of tivxReferenceImportHandle</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#TIOVX_SAFETY_RESOURCE_TEARDOWN">TIOVX Resource Teardown</a></li>
<li class="level1"><a href="#TIOVX_SAFETY_SPINLOCK_USAGE">TIOVX Spinlock Usage and Recommendations</a></li>
<li class="level1"><a href="#TIOVX_SAFETY_IPC">TIOVX IPC Implementation</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="TIOVX_SAFETY_INITIALIZATION"></a>
TIOVX Initialization in Safety Systems</h1>
<p>TI provides sample host side application code along with target side sample firmware within the "vision_apps" project (included with the PSDK RTOS). This serves as an example for how the initializations should be done within a system integrating TIOVX. There are several modules within the "app_utils" project which require initialization in order for TIOVX to work properly, including such items as shared memory, IPC, Sciclient, etc.</p>
<p>For host side initialization of TIOVX, the appInit function within vision_apps/utils/app_init shall be called. This function calls the appCommonInit, <a class="el" href="group__group__tivx__ext__host.html#gad7aa0fdded06205fb515f77c60e8cac7">tivxInit</a> and <a class="el" href="group__group__tivx__ext__host.html#ga31ae176c89afc45e20c15ed60b0023d0">tivxHostInit</a> calls. The appCommonInit call performs the necessary host side initializations outside of TIOVX, including the set up of shared memory, IPC, timers as well as some optional initializations such as logging, performance measurement, etc. This function is supported on both Linux and QNX, with the only difference across the two is the resource table usage on Linux (not supported on QNX). The API also ensures that these initializations are only performed once per system, in the case of multi-threaded or multi-process designs.</p>
<p>For target side initialization of TIOVX, the example initialization of firmware occur within the vision_apps/platform/&lt;soc&gt;/rtos/common/app_init.c. This file is common across all remote cores of the system and has modules enabled/disabled based on the settings in vision_apps/platform/&lt;soc&gt;/rtos/common/app_cfg*.h. In order for TIOVX to be properly enabled, the ENABLE_TIOVX, ENABLE_IPC and ENABLE_SCICLIENT must be set. Additionally, depending on the kernels enabled in the system, certain memory sections may also be required if they are depended on by the respective kernels.</p>
<p>Within the ENABLE_TIOVX macro, the key initialization call in order for TIOVX to be enabled properly is <a class="el" href="group__group__tivx__ext__host.html#gad7aa0fdded06205fb515f77c60e8cac7">tivxInit</a>.</p>
<p>Furthermore, specific memory region carveouts are required in order for TIOVX to work properly. More details can be found in the "Understanding and updating SDK
 memory map for &lt;SOC&gt;" document in the PSDK RTOS top level developer notes.</p>
<p>One specific API which is of interest in the set up of these memory regions is the tivxPlatformResetObjDescTableInfo function. This function resets the object descriptor table at init time. This function is called solely on the remote core side since the RTOS cores init prior to the A-core. This function shall not be called from the A-core host side or separate from init time, otherwise it could cause undefined behavior.</p>
<p>In order to facilitate the adherence to the alignment and size requirements of these regions in the case of custom memory maps, build asserts have been added to the TIOVX code in order to catch issues at the build stage of TIOVX.</p>
<p>The vision_apps project also provides the "vision_apps_init.sh" script which enables remote core logging on the firmware. This allows a developer to see if there were any initialization or run-time error logs from the firmware. Furthermore, the vision_apps firmware performs a ping test once all the required firmwares have been initialized successfully, helping to identify issues during initialization from the remote firmware. If this ping test does not succeed, it does not allow further processing to occur on that remote core, as it may be in a bad state. Refer to the vision_apps user guide for more information about this diagnostics for help identifying issues in the remote firmware.</p>
<h1><a class="anchor" id="TIOVX_SAFETY_USAGE"></a>
TIOVX Usage Recommendations for Safety</h1>
<p>When utilizing TIOVX within a safety system, there are a few things to note regarding the implementation of various API's.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_USAGE_DELAY"></a>
Delay Object Support</h2>
<p>The <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/de/d09/group__group__delay.html#ga2c6de63476aff4a009bac8d0eb9800d1">vx_delay</a> objects have limited support within TIOVX, particularly when using them within pipelining. Thus, it is not recommended to use <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/de/d09/group__group__delay.html#ga2c6de63476aff4a009bac8d0eb9800d1">vx_delay</a> objects with pipelining. The section <a class="el" href="TIOVX_PIPELINING.html#TIOVX_PIPELINING_PERFORMANCE_OPTIMIZATION_DELAY_PARAMETERS">Pipelining with Delay Objects</a> provides more details on this limitation and alternative means by which to implement similar functionality.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_USAGE_COMPOSITE_OBJECTS"></a>
Composite Object Pipelining Support</h2>
<p>Similarly, composite objects such as <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/db/d9f/group__group__object__array.html#ga31a0de03c8cbf474afab6efb7bcffddb">vx_object_array</a> and <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/db/d29/group__group__pyramid.html#gad9e43dc4026a9593d63e3e9881b9c4d9">vx_pyramid</a> have certain limitations with pipelining. The section <a class="el" href="TIOVX_PIPELINING.html#TIOVX_PIPELINING_USAGE_CONSIDERATIONS_COMPOSITE_OBJECTS">Pipelining with Composite Objects</a> provides more details on this limitation and alternative means by which to implement similar functionality.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_USAGE_MAP_COPY"></a>
Safety Implications of TIOVX Map and Copy API Implementation</h2>
<p>Per the section <a class="el" href="TIOVX_USAGE_REC.html#TIOVX_USAGE_MAP_COPY_API">Map and Copy API Usage in TIOVX</a>, there are some safety implications for the map and copy API's implementations within TIOVX. Given that these API's allocate memory prior to graph verification, the application developer must by cognizant of this fact when creating the TIOVX-based application. In particular, if using data objects as exemplars or other such elements disconnected from the graph, it is possible that the available memory of the system can be reached prior to the call to <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a> and thus should be taken into account when designing the system.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_USAGE_NESTED_NODE"></a>
Nested Node Safety Usage Information</h2>
<p>Nested nodes provide the ability to use the functionality of a <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#ga7e71c08b1777e49abaf4417506ca8451">vx_graph</a> within a <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#ga7f1b5d91fac63093ee3a77e87d942f96">vx_node</a>. However, graph event handling within a nested node is not yet handled. Therefore, in the meantime, it is recommended that from the application point of view, a nested node should be registered with a given timeout and that if that timeout is exceeded, the cores which are used within the nested node need to be rebooted.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_USAGE_FURTHER_INFO"></a>
Further information</h2>
<p>For full details, please reference the TIOVX usage sections at the location <a class="el" href="TIOVX_USAGE.html">TIOVX Usage</a></p>
<h1><a class="anchor" id="TIOVX_SAFETY_MEMORY_MANAGEMENT"></a>
TIOVX Memory Management for Safety</h1>
<p>A critical component of safety SW systems is the memory management scheme. Please reference the section <a class="el" href="TIOVX_MEMORY_MANAGEMENT.html">Memory Management in TIOVX</a> for details on how memory management is handled in TIOVX and how it facilitates safety.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_MEMORY_MANAGEMENT_APPLICATION"></a>
Requirements for Application Usage of OpenVX data objects</h2>
<p>OpenVX has a clear “initialization” phase, “run-time” phase, and “deinit” phase for each graph. The initialization phase for a graph ends when the call to <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a> returns. With one specific case exception listed below, all of the resources are initialized, and at no point in the run-time phase the framework or kernels allocate memory. (Note that it is possible that the application itself may still allocate memory as in the case of the control callback objects discussed below.)</p>
<p>The exception to this case is if the application wants to call control commands which require it to create additional OpenVX references which are not already node parameters and thus allocated as a part of the verify graph call. Due to this fact, an application should ideally create, map and unmap these data references prior to the call to <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a>. This allows the data references to be allocated and thus the full system memory will be considered when returning a status from the graph verification.</p>
<p>If an application initializes all of the graphs it expects to run prior to running, it is guaranteed that it has all the memory resources reserved and will not run into an out of memory condition or memory fragmentation, which is the primary rationale for this rule. In the case of having multiple graphs spanning multiple threads or processes, the create and verification of all graphs in a system shall be called prior to the process phase of any graph in the system. This is the recommended approach when using OpenVX.</p>
<p>In TIOVX, all framework and data objects “created” in the init phase reserve statically allocated slots in a specific global memory array of objects, and max values that define the length of this array are defined statically at build time using the respective SoC <a class="el" href="tivx__config_8h_source.html">tivx_config.h</a>. During development, if a use case exceeds the max allocation from these lists, then a run-time terminal error print which says which value to increase in this file, and the user can rebuild and run again. In order to ensure no memory is wasted, we have a feature where the user can initialize their application to be used in production and run a function which creates an updated version of this file which sets all the max values to the peak usage at the time that the function was called. This way the user can recompile the framework using this new header file and only allocate the memory required for this application use case.</p>
<p>For data buffers, there is a specific contiguous shared memory carveout that data buffers get allocated out of during the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a> function call. Since these are all done during initialization time, then once the vxVerifyGraph function returns, that graph will never experience an out of memory or memory fragmentation issue.</p>
<p>When designing applications, the application shall not selectively delete graphs or memory associated with OpenVX objects. Rather, it should persist throughout the duration of the application. The reason for this is that selective deletion and re-creation of various OpenVX objects can lead to memory fragmentation.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_MEMORY_MANAGEMENT_OBJ_DESCRIPTOR_TABLE"></a>
Requirement for object descriptor table</h2>
<p>As mentioned above and in the <a class="el" href="TIOVX_MEMORY_MANAGEMENT.html">Memory Management in TIOVX</a> documentation, TIOVX uses a table of object descriptors in non-cached memory which are exchanged across nodes in order to access data buffers. Upon firmware boot, this table is reset by the remote core firmware and not on the host side. Furthermore, this table is modified by the framework when new object descriptors are populated or removed from the table.</p>
<p>From the application side, it is necessary to avoid applications writing into this memory, as this will corrupt the object descriptors and therefore could result in invalid reads or writes from remote cores.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_MEMORY_MANAGEMENT_PHYS_ADDR"></a>
Note about Physical Addresses</h2>
<p>As a note to application developers, physical addresses are used in multiple places within user space (for instance, with the API <a class="el" href="group__group__tivx__mem.html#ga571ad5461f5c182083ee352164039765">tivxMemTranslateVirtAddr</a>). This is important to note, as a misbehaving application could corrupt this value and cause crashes on remote cores. Care should be taken to avoid corrupting these values within the application.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_EXTERNALLY_ALLOCATED_MEMORY"></a>
Requirements for Memory Allocated Outside of TIOVX Framework</h2>
<p>Certain API's allow an OpenVX data object to be associated with memory allocated from outside of the framework. There are several important constraints for such memory. There are a few API's in question which are explained further below.</p>
<h3><a class="anchor" id="TIOVX_SAFETY_EXTERNALLY_ALLOCATED_MEMORY_IMAGE"></a>
Requirements of vxCreateImageFromHandle and vxSwapImageHandle</h3>
<p>Both the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#ga5abb694617a79024621e3ba95237a109">vxCreateImageFromHandle</a> and <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#ga95876e3ba7123ff80a51fdc55a0cf5c0">vxSwapImageHandle</a> API allow for the importing of memory which may or may not have been allocated using the TIOVX framework to a <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#gafaa07841fe324f1c1d5b0f27c27de7b5">vx_image</a> object. In order to avoid errors, the memory which is being imported to these objects are required to be allocated using the <a class="el" href="group__group__tivx__mem.html#ga99635ddb13baefecfbb1cf262437ca46">tivxMemAlloc</a> API even though there are no explicit error checks in the framework for this requirement.</p>
<h3><a class="anchor" id="TIOVX_SAFETY_EXTERNALLY_ALLOCATED_MEMORY_IMPORT"></a>
Requirements of tivxReferenceImportHandle</h3>
<p>The <a class="el" href="group__group__tivx__reference.html#ga624fdc5a1923380d531aa5434ca9ee57">tivxReferenceImportHandle</a> API has several important restrictions in how it is to be used within TIOVX. The API guide gives details as to the requirements of the imported handle, which must be adhered to. In particular, there are a few important aspects of the imported handles that need to be reviewed below:</p>
<ul>
<li>OpenVX data type requirements. The only provided list of data types are valid.</li>
<li>Memory region requirements. An error is thrown if the memory is not created from the region specified</li>
<li>Memory alignment requirements. While there is not a check for this given that it is simply a memory address, the API is required to be used for memory allocation will automatically align the memory to the required alignment</li>
<li>There is an error thrown if the corresponding number of entries doesn't match a set of number of valid addresses. If the total number of memory pointers are not equal to the number of pointers required for the reference, then an error will be thrown.</li>
<li>Subimages of a given image object will not be imported to the subsequent imported image object.</li>
</ul>
<p>For more information about how to use this API, please refer to the Producer/Consumer application within vision_apps as well as the test cases found at tiovx/conformance_tests/test_tiovx/test_tivxMem.c</p>
<h1><a class="anchor" id="TIOVX_SAFETY_RESOURCE_TEARDOWN"></a>
TIOVX Resource Teardown</h1>
<p>For applications created using TIOVX as the middleware, the resource teardown shall be considered in the development of the applications. While TIOVX provides API's to release references that have previously been created, this logic must be called in the case that an event is received at the application level which causes an abort. Signal handler logic should handle the teardown of OpenVX data objects that had previously been created. The implementation of this logic will depend on the OS used by the OpenVX host core.</p>
<p>In order to understand how this shall be implemented within an OpenVX-based application with the OpenVX host running on a POSIX-based OS, please reference the "File Descriptor Exchange across Processes" application found within the vision apps package of the PSDK RTOS. This application registers a signal handler which is executed upon a Ctrl-C signal. This is done using the code snippet below:</p>
<div class="fragment"><div class="line">signal(SIGINT, App_intSigHandler);</div></div><!-- fragment --><p>Within the App_intSigHandler, the application calls App_deInit, which calls the teardown logic associated with all of the OpenVX objects contained within the application.</p>
<p>For information about ensuring that all resources have been freed appropriately, please reference <a class="el" href="TIOVX_SAFETY_TOOLING.html">TIOVX Safety Tooling</a>.</p>
<h1><a class="anchor" id="TIOVX_SAFETY_SPINLOCK_USAGE"></a>
TIOVX Spinlock Usage and Recommendations</h1>
<p>There are a few different scenarios in which a spinlock is required to be used by TIOVX in order to provide exclusive access amongst the multiple cores which may require access to a given piece of information. The 3 scenarios are listed below along with the spinlock ID which is used for that scenario:</p>
<ul>
<li>Run time event logger: <a class="el" href="group__group__tivx__platform.html#gaf9eea5e8de73b83195a47547aee7cf72">TIVX_PLATFORM_LOCK_LOG_RT_HW_SPIN_LOCK_ID</a></li>
<li>Object descriptor table: <a class="el" href="group__group__tivx__platform.html#gaadd07d490ec3794eed6ef85e16184a6f">TIVX_PLATFORM_LOCK_OBJ_DESC_TABLE_HW_SPIN_LOCK_ID</a></li>
<li>Data reference queue: <a class="el" href="group__group__tivx__platform.html#ga3c6962f55f52aafa438a996f3dd5240d">TIVX_PLATFORM_LOCK_DATA_REF_QUEUE_HW_SPIN_LOCK_ID</a></li>
</ul>
<p>There is no resource manager for spinlocks within the SDK. Therefore, it is important for an application developer to guarantee that no other piece of software assumes access to these locks. If other software components are using these locks, it will cause significant delays in execution of TIOVX.</p>
<h1><a class="anchor" id="TIOVX_SAFETY_IPC"></a>
TIOVX IPC Implementation</h1>
<p>The remote core IPC utils uses a locally set endpoint number which it uses to communicate amongst HLOS and other RTOS cores. Therefore, the RTOS remote cores are trusting the HLOS to use the proper endpoint; otherwise, the communication may be sent to the wrong endpoint. If an application uses the default IPC utils, this is already taken care of, but if an application uses some other means of establishing IPC across cores, issues could arise if this fact is not considered. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="REFERENCES.html">User Resources</a></li><li class="navelem"><a class="el" href="TIOVX_SAFETY.html">TIOVX Safety Manual</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
