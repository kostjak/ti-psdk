<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TIOVX User Guide: TIOVX Safety Features</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TIOVX User Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('TIOVX_SAFETY_FEATURES.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TIOVX Safety Features </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#TIOVX_SAFETY_FEATURES_TIMEOUT">TIOVX Timeout</a><ul><li class="level2"><a href="#TIOVX_SAFETY_FEATURES_TIMEOUT_NODE">Node Timeouts</a></li>
<li class="level2"><a href="#TIOVX_SAFETY_FEATURES_TIMEOUT_GRAPH">Graph Timeouts</a><ul><li class="level3"><a href="#TIOVX_SAFETY_FEATURES_TIMEOUT_GRAPH_STREAMING">Graph Timeouts Usage with Graph Streaming</a></li>
</ul>
</li>
<li class="level2"><a href="#TIOVX_SAFETY_FEATURES_TIMEOUT_CUSTOM">Custom Timeout Configuration in Target Kernel</a></li>
</ul>
</li>
<li class="level1"><a href="#TIOVX_SAFETY_FEATURES_EVENT">TIOVX Event API</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="TIOVX_SAFETY_FEATURES_TIMEOUT"></a>
TIOVX Timeout</h1>
<p>By default, certain API's within OpenVX allow users to specify timeout values for the API operation. This can be useful in the case of a heterogeneous system such as TI's SoC's in the event that a remote processor or OpenVX target experiences a fault and thus cannot receive new messages from the host CPU. Given the plausibility of this event occurring, safety systems must have a mechanism by which to recover from this issue.</p>
<p>If any of the blocking calls of API's from the following OpenVX objects fail due to a timeout issue, the return value will be VX_ERROR_TIMEOUT. More information about how timeouts can be used with these objects is described below.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_FEATURES_TIMEOUT_NODE"></a>
Node Timeouts</h2>
<p>For the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#ga7f1b5d91fac63093ee3a77e87d942f96">vx_node</a> API, a timeout can be specified by calling the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#gad5a8c201296752904d3c5a679320b478">vxSetNodeAttribute</a> API with the attribute <a class="el" href="group__group__tivx__attribute__extension.html#gga9755252d3999300b6c34e9140d9cebc1ad56b494feb15d5c991dacbf0043251c0">TIVX_NODE_TIMEOUT</a>. The timeout value can also be queried using the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#gac7d60a2cde3f9833725f345e5c5d185f">vxQueryNode</a> API.</p>
<p>In the case that a timeout occurs during the create or delete commands of a node, the error will get propogated through the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a> or <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#ga1334f741d1c76d27a0e26117603885f1">vxReleaseGraph</a> calls.</p>
<p>The TI extension API <a class="el" href="group__group__tivx__node.html#ga00ddc13a203bd6c3d96693ced363d9c8">tivxNodeSendCommandTimed</a> also allows for specifying a timeout value at which time the API will return the VX_ERROR_TIMEOUT value.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_FEATURES_TIMEOUT_GRAPH"></a>
Graph Timeouts</h2>
<p>The Pipelining 2.0 specification provides the ability to specify a timeout for blocking calls within the standard implementation. For the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#ga7e71c08b1777e49abaf4417506ca8451">vx_graph</a> API, a timeout can be specified by calling the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#ga816cb2fa16fd674c3f0ae0721760db27">vxSetGraphAttribute</a> API with the attribute <a class="el" href="group__group__pipelining.html#gga5497eb0a9577d9855ec553d5154ab675aa3e3d1013d8111cf4c01f04ef13efb6e">VX_GRAPH_TIMEOUT</a>. The timeout value can also be queried using the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaf7d8226c9d24304b2552ffa1aacf79a6">vxQueryGraph</a> API. Please refer to this specification for further details on how to implement this feature within an application.</p>
<p>The blocking calls are considered within the Pipelining 2.0 specification for timeouts; however, there are some additional timeout considerations within the implementation of TIOVX due to the underlying IPC mechanisms within certain API's which are typically non-blocking at the OpenVX specification point of view. Since it is possible for an IPC mechanism to timeout within these non-blocking API's, it is possible to encounter a timeout error within these API's.</p>
<p>The following graph related API's may return the VX_ERROR_TIMEOUT error when enabling timeouts on the graph or nodes within the graph due to this scenario, even though they are non-blocking. It is very important to note that even if the graph timeout is set, the below two API's may still block due to the underlying IPC occurring when calling the create and delete callbacks. Therefore, to avoid this blocking call, every node in the graph must also have a timeout set via the <a class="el" href="group__group__tivx__attribute__extension.html#gga9755252d3999300b6c34e9140d9cebc1ad56b494feb15d5c991dacbf0043251c0">TIVX_NODE_TIMEOUT</a> attribute.</p><ul>
<li><a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a></li>
<li><a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#ga1334f741d1c76d27a0e26117603885f1">vxReleaseGraph</a></li>
</ul>
<p>The documentation section <a class="el" href="TIOVX_TARGET_KERNEL.html">User Kernels and User Target Kernels</a> provides some additional details about how the timeouts interact with the target kernel callback structure.</p>
<h3><a class="anchor" id="TIOVX_SAFETY_FEATURES_TIMEOUT_GRAPH_STREAMING"></a>
Graph Timeouts Usage with Graph Streaming</h3>
<p>When using the graph streaming feature from the Pipelining and Streaming extension, special considerations need to be made for how to handle various timeout scenarios. As a quick background on the internal implementation of streaming, the framework creates a separate task which manages the streaming execution of the graph and thus will allow the graph to re-trigger upon completion of the trigger node. Therefore, a general recommended practice when using graph streaming is to use the <a class="el" href="vx__khr__pipelining_8h.html#aea654eca6a3a341e9d0c65e3cbff605b">vxRegisterGraphEvent</a> to register a <a class="el" href="group__group__event.html#gga21a4f8180495b5c7616f790bc9fbe14ca810823f0980188a018dcbfd7d1aa77ae">VX_EVENT_NODE_ERROR</a> event on the trigger node of the streaming graph. This way, if an error occurs within the graph as a result of either timeout or any general error, the application will become aware of this issue. As an example, if a timeout error occurs (for instance, due to a crash on a remote core), the node error event will be triggered and thus allow the application to tear down the graph. One important note to be aware of is that the internal queue which manages this task will time out if the specified <a class="el" href="group__group__pipelining.html#gga5497eb0a9577d9855ec553d5154ab675aa3e3d1013d8111cf4c01f04ef13efb6e">VX_GRAPH_TIMEOUT</a> is exceeded. This decision was made since the timeout for the queue would always be less than or equal to this graph timeout, as new data is enqueued to this queue at the rate of the trigger node completion.</p>
<h2><a class="anchor" id="TIOVX_SAFETY_FEATURES_TIMEOUT_CUSTOM"></a>
Custom Timeout Configuration in Target Kernel</h2>
<p>For a custom target kernel, a timeout can be implemented at the callback level in order to return in the case that the timeout needs to be set at that granularity.</p>
<p>The recommended approach to achieve this is to configure the node API to pass a <a class="el" href="group__group__user__data__object.html#ga863903e2890171d914598216e0727d73">vx_user_data_object</a> containing timeout values to the custom node. The <a class="el" href="group__group__tivx__task.html#ga25fc34b7c559f1be5d8a237dd26eaf24">tivxTaskWaitMsecs</a> can then be used when setting the timeout. Please reference the target kernel implementation of the tivxCmdTimeoutTestNode for an example of how this can be achieved.</p>
<h1><a class="anchor" id="TIOVX_SAFETY_FEATURES_EVENT"></a>
TIOVX Event API</h1>
<p>TIOVX supports the event handling API which is included in the OpenVX Pipelining 2.0 extension (link found in <a class="el" href="RESOURCES.html">Resources</a>).</p>
<p>This event handling API can be useful for detecting node level errors by using VX_EVENT_NODE_ERROR within the <a class="el" href="group__group__event.html#ga21a4f8180495b5c7616f790bc9fbe14c">vx_event_type_e</a> enumeration. This allows an application to use the <a class="el" href="group__group__event.html#ga7185b791138b8332729e59cae177b6b6">vxRegisterEvent</a> API to know when an error has occurred within the process callback of a node.</p>
<p>If more diagnostic information from the node is needed, the suggested approach for determining any further information is to additionally register a control callback within the node which can be queried by the application if an error has occurred. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="REFERENCES.html">User Resources</a></li><li class="navelem"><a class="el" href="TIOVX_SAFETY.html">TIOVX Safety Manual</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
