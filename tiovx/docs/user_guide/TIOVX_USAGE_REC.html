<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TIOVX User Guide: TIOVX Usage Recommendations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ti_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TIOVX User Guide
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('TIOVX_USAGE_REC.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TIOVX Usage Recommendations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#TIOVX_USAGE_REC_SET_NODE_TARGET">vxSetNodeTarget()</a></li>
<li class="level1"><a href="#TIOVX_USAGE_REC_REMAP">vxGetRemapPoint() and vxSetRemapPoint()</a></li>
<li class="level1"><a href="#TIOVX_USAGE_STRIDE">Stride Alignment for Images and Raw Images</a></li>
<li class="level1"><a href="#TIOVX_USAGE_REC_GRAPH_PERF">Graph Performance API&#39;s with pipelining</a></li>
<li class="level1"><a href="#TIOVX_USAGE_REC_WORKER_THREAD">Enabling a node within the graph to run at lower FPS than rest of graph</a></li>
<li class="level1"><a href="#TIOVX_USAGE_VIRTUAL_OBJECTS">Virtual Object Support in TIOVX</a></li>
<li class="level1"><a href="#TIOVX_USAGE_MAP_COPY_API">Map and Copy API Usage in TIOVX</a></li>
<li class="level1"><a href="#TIOVX_USAGE_IMAGE_API">TIOVX Implementation of Image API&#39;s</a></li>
<li class="level1"><a href="#TIOVX_USAGE_SUBIMAGE_API">TIOVX Implementation of Subimages</a></li>
<li class="level1"><a href="#TIOVX_USAGE_REC_SEND_NODE_COMMAND">tivxNodeSendCommand()</a></li>
<li class="level1"><a href="#TIOVX_USAGE_SUPPL_DATA">Supplementary Data with Composite Objects from Exemplar</a></li>
<li class="level1"><a href="#TIOVX_USAGE_TASK">TIOVX Task API on MPU Cores</a></li>
<li class="level1"><a href="#TIOVX_USAGE_CACHE_IMPLICATIONS">Using TIVX_MEMORY_TYPE_DMA</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="TIOVX_USAGE_REC_SET_NODE_TARGET"></a>
vxSetNodeTarget()</h1>
<ul>
<li><a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#ga7409f4d86e22259caae9c0d42b18cbd9">vxSetNodeTarget()</a> should only be called on nodes of a graph before calling <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph()</a> for that graph.</li>
<li>If a kernel that has only one available target is instantiated, the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#ga7409f4d86e22259caae9c0d42b18cbd9">vxSetNodeTarget()</a> API does not have to be called for that instantiated kernel. It will default to the only available target.</li>
<li>If multiple targets are available for a given kernel and the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d7/d61/group__group__node.html#ga7409f4d86e22259caae9c0d42b18cbd9">vxSetNodeTarget()</a> is not called, the framework will default to the first target added to the kernel via the <a class="el" href="group__group__tivx__kernel.html#ga96ea87bdaa937afaaddfed3704dad109" title="Associate a target with a kernel. ">tivxAddKernelTarget()</a> API, which is called when adding the target kernel to the context.</li>
<li>As per a requirement of the conformance tests, the vxSetNodeTarget API accepts string target values of "any", "aNy" and "ANY" then the behaviour is the same as if the VX_TARGET_ANY enum was passed. If a legitimate TI-target is required for a given node, that target value must be provided to the API. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_REC_REMAP"></a>
vxGetRemapPoint() and vxSetRemapPoint()</h1>
<ul>
<li>The <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d3/db0/group__group__remap.html#gadf470be9db9a071bf735ab977cee25db">vxGetRemapPoint()</a> and <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d3/db0/group__group__remap.html#gadd9f8ee866b4ee949ea572022ed1bc7f">vxSetRemapPoint()</a> API's must always get or set the (0,0) element first prior to any other get or set. Additionally, the element at (remap_width, remap_height) must be set or gotten last. This is because getting or setting the (0,0) element performs a map of the remap object and getting or setting the (remap_width, remap_height) element performs an unmap of the remap object. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_STRIDE"></a>
Stride Alignment for Images and Raw Images</h1>
<ul>
<li>TIOVX automatically aligns the stride of images and raw images to the value of <a class="el" href="group__group__vx__utils.html#gafed0fc37f24bfac4e4593ee9d3b87c8e">TIVX_DEFAULT_STRIDE_Y_ALIGN</a>. This is a requirement of certain hardware accelerators (such as LDC) and should not be modified. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_REC_GRAPH_PERF"></a>
Graph Performance API's with pipelining</h1>
<ul>
<li>The graph performance API's (<a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#ggafb1ab4fbc75aedc1bf2f096a55afa58aa76daec669b2f5ce44d44fa19455b74a2">VX_GRAPH_PERFORMANCE</a>) give the overall time to execute a graph.</li>
<li>However, when using the pipelining extension, this may not be as useful in the case that one may need to calculate the frame rate of the graph.</li>
<li>In this case, it is recommended to use the API's provided in vision_apps for calculating the frame rate and other performance information <a href="https://software-dl.ti.com/jacinto7/esd/processor-sdk-rtos-jacinto7/latest/exports/docs/vision_apps/docs/user_guide/group__group__vision__apps__utils__perf__stats.html" target="_blank">here</a> </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_REC_WORKER_THREAD"></a>
Enabling a node within the graph to run at lower FPS than rest of graph</h1>
<ul>
<li>In some situations, it may be desirable to have a node within the graph run at a lower FPS than the rest of the graph.</li>
<li>In these scenarios, the node itself can be customized using the steps below to accomplish this.<ul>
<li>A thread can be created from the create callback of the custom node.</li>
<li>Pass message/control commands from this thread in process callback.</li>
<li>Close thread from destroy callback</li>
</ul>
</li>
<li>This is done in the tivxHwaVpacVissNode to pass information to the tivxAewbNode and can be referenced for custom node implementations. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_VIRTUAL_OBJECTS"></a>
Virtual Object Support in TIOVX</h1>
<ul>
<li>While the OpenVX standard specification provides a provision for implementations to optimize memory footprint via virtual objects, the TIOVX framework does not provide any added optimization from using virtual objects.</li>
<li>Certain nodes, such as the DSS M2M node and the Mosaic node, do not support virtual objects. In these cases, the standard objects should be used instead. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_MAP_COPY_API"></a>
Map and Copy API Usage in TIOVX</h1>
<ul>
<li>Each OpenVX data object has an associated vxMap&lt;Data_Object&gt; and vxCopy&lt;Data_Object&gt; API.</li>
<li>In general, all memory allocation within TIOVX occurs during the <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a> call, in order to provide a single return regarding whether or not a system has sufficient memory to run applications. Therefore, even if the data object is created via the vxCreate&lt;Data_Object&gt; API, the memory will only be allocated at the call to <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a>.</li>
<li>There are a few exceptions to this rule:<ul>
<li>The vxMap&lt;Data_Object&gt; and vxCopy&lt;Data_Object&gt; API's are an exception to this rule about memory allocation occurring at a single point. Given that these API's return a pointer to the object data buffer, the memory for these data objects are allocated in the call to vxMap&lt;Data_Object&gt; and vxCopy&lt;Data_Object&gt;. When the call to <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/d9/d7f/group__group__graph.html#gaa815ffa0b7cc2598d3d53bffc7c8c154">vxVerifyGraph</a> occurs, it will have already allocated this memory prior to executing the graph verification.</li>
<li>An additional exception to this rule is for the <a class="el" href="group__group__user__data__object.html#ga863903e2890171d914598216e0727d73">vx_user_data_object</a> API <a class="el" href="group__group__user__data__object.html#ga4192979f05bbf887c98e1653baeaf4f6">vxCreateUserDataObject</a>. This API allows the developer to provide a data structure instance to populate the memory at creation of the <a class="el" href="group__group__user__data__object.html#ga863903e2890171d914598216e0727d73">vx_user_data_object</a> itself. Therefore, in this case, the memory for the <a class="el" href="group__group__user__data__object.html#ga863903e2890171d914598216e0727d73">vx_user_data_object</a> will be allocated.</li>
<li>Similarly, the memory for a <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/de/d7e/group__group__scalar.html#ga1bf12c9f0e72ed39970212b04148788d">vx_scalar</a> will be allocated when calling <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/de/d7e/group__group__scalar.html#ga53933b83d7efdbad0a55b742a6316318">vxCreateScalar</a> in the case that a scalar value is passed at create time. </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_IMAGE_API"></a>
TIOVX Implementation of Image API's</h1>
<ul>
<li>The <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#gafaa07841fe324f1c1d5b0f27c27de7b5">vx_image</a> API's below allow an application to use an allocated handle to create or swap into an OpenVX image object<ul>
<li><a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#ga5abb694617a79024621e3ba95237a109">vxCreateImageFromHandle</a></li>
<li><a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#ga95876e3ba7123ff80a51fdc55a0cf5c0">vxSwapImageHandle</a></li>
</ul>
</li>
<li>An important note about these API's is that the handles used by these API's must be allocated using <a class="el" href="group__group__tivx__mem.html#ga99635ddb13baefecfbb1cf262437ca46">tivxMemAlloc</a> rather than by using malloc or other such memory. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_SUBIMAGE_API"></a>
TIOVX Implementation of Subimages</h1>
<ul>
<li>The OpenVX specification does not define the depth of the number of the subimages which a <a class="elRef" doxygen="/home/dockeruser/psdk_installer_build_top_workarea/scratch_workarea/staging_area/tiovx/internal_docs/doxy_cfg_user_guide/openvx.tag:https://www.khronos.org/registry/OpenVX/specs/1.1/html/" href="https://www.khronos.org/registry/OpenVX/specs/1.1/html/df/d09/group__group__image.html#gafaa07841fe324f1c1d5b0f27c27de7b5">vx_image</a> may contain</li>
<li>Therefore, the TIOVX implementation has added a max value of "2" for the number of subimage levels, as well as a max value of "16" for the number of subimages per level.</li>
<li>These are configurable and can be updated in the max value configuration file. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_REC_SEND_NODE_COMMAND"></a>
tivxNodeSendCommand()</h1>
<ul>
<li>The intention behind the <a class="el" href="group__group__tivx__node.html#ga4cb7e62dba45e9c2fdb49bdb0dc8c3a8">tivxNodeSendCommand()</a> is to send non-real time data to a node and/or to query for information from the node</li>
<li>Particularly if using pipelining, this API shall not be used for sending/receiving data from a node for every execution of the node. If that is the requirement of a given use case, the node API should be changed to encapsulate this parameter. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_SUPPL_DATA"></a>
Supplementary Data with Composite Objects from Exemplar</h1>
<ul>
<li>For the specific scenario of creating a composite object (i.e., a vx_pyramid or a vx_object_array) from exemplar when the composite object used as the exemplar contains supplementary data, the children objects of the resulting composite object will contain the same supplementary data as the base object (i.e., the vx_pyramid or vx_object_array).</li>
<li>As an example, in the case that a vx_object_array "ABC" is created with supplementary data "XYZ", if an exemplar of object ABC is created, then the resulting object array elements will contain supplementary data "XYZ" as well. </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_TASK"></a>
TIOVX Task API on MPU Cores</h1>
<ul>
<li>When used on MPU cores running an HLOS (i.e., Linux or QNX), the priority parameter of the <a class="el" href="structtivx__task.html" title="Typedef for a task. ">tivx_task</a> API is ignored. This is left to maintain compatibility with RTOS.</li>
<li>If a thread needs to be created with a priority, please instead use the native pthread API </li>
</ul>
<h1><a class="anchor" id="TIOVX_USAGE_CACHE_IMPLICATIONS"></a>
Using TIVX_MEMORY_TYPE_DMA</h1>
<ul>
<li>For buffers of type VX_MEMORY_TYPE_HOST, the host core will manage the buffer and perform its corresponding cache operations.</li>
<li>However, a buffer with a memory type of TIVX_MEMORY_TYPE_DMA will not necessarily mean a DMA will be accessing the buffer.<ul>
<li>Rather, it simply means cache operations on buffer will be skipped.</li>
</ul>
</li>
<li>This makes buffers of TIVX_MEMORY_TYPE_DMA faster.<ul>
<li>This comes at the tradeoff of the application ensuring stale data is not created.</li>
<li>Additionally, each TI SoC has their own cache implementation and validation policies, which using VX_MEMORY_TYPE_HOST would normally abstract from the application.</li>
</ul>
</li>
<li>A performance optimization could occur when, for example, only small pieces of a buffer are accessed, which would make it ineffective to maintain cache operations on the full buffer.<ul>
<li>In this case the application can use a buffer TIVX_MEMORY_TYPE_DMA which skips the maintenance, and later the developer can perform the maintenance on just the pieces of the buffer accessed. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="REFERENCES.html">User Resources</a></li><li class="navelem"><a class="el" href="TIOVX_USAGE.html">TIOVX Usage</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
