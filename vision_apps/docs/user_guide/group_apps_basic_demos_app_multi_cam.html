<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>Vision Apps User Guide: Multi Camera VPAC Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vision Apps User Guide
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group_apps_basic_demos_app_multi_cam.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Multi Camera VPAC Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md60">Introduction</a></li>
<li class="level1"><a href="#autotoc_md61">Supported plaforms</a></li>
<li class="level1"><a href="#autotoc_md62">Data flow (RAW12 input)</a></li>
<li class="level1"><a href="#autotoc_md63">Steps to run the application on J7 EVM (Linux + RTOS mode)</a></li>
<li class="level1"><a href="#autotoc_md64">Steps to run the application on J7 EVM (QNX + RTOS mode)</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md60"></a>
Introduction</h1>
<p>This application demonstrates the use of VISS node and TI's 2A (AE &amp; AWB) algorithm in multi-channel mode. The dataflow is</p>
<ol type="1">
<li>Configure image sensors using sensor driver f/w APIs</li>
<li>Acquire RAW images from camera sensors</li>
<li>Process the images on VISS</li>
<li>Run AE (Auto Exposure) and AWB (AutoWhiteBalance) algorithms, using H3A output from VISS</li>
<li>Run LDC on the output of VISS</li>
<li>Scale LDC output using MSC and arrange in a mosaic</li>
<li>Display the mosaic using Display Sub-System</li>
</ol>
<p>Any number of cameras from 1-8 (up to 12 with J784S4 + Fusion2 board) can be selected by the user, subject to constraints of sensor driver. The application assumes that all cameras are identical.</p>
<h1><a class="anchor" id="autotoc_md61"></a>
Supported plaforms</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Platform  </th><th class="markdownTableHeadNone">Linux x86_64  </th><th class="markdownTableHeadNone">Linux+RTOS mode  </th><th class="markdownTableHeadNone">QNX+RTOS mode  </th><th class="markdownTableHeadNone">SoC   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Support  </td><td class="markdownTableBodyNone">NO  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">YES  </td><td class="markdownTableBodyNone">J721e / J721S2 / J722S / J784S4 / J742S2   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md62"></a>
Data flow (RAW12 input)</h1>
<div class="image">
<img src="app_multi_cam_data_flow.png" alt="app_multi_cam_data_flow.png"/>
</div>
<p>If running on J784S4, there is an option to split the graph into 2 separate pipelines which get merged together at the mosaic node. This allows the graph to utilize both VPAC's that are present on J784S4. This option is enabled by default on J784S4, but can be disabled by setting the "bypass_split_graph" to "1" in the config file. The diagram for this configuration can be seen below:</p>
<div class="image">
<img src="app_multi_cam_j784s4_data_flow.png" alt="app_multi_cam_j784s4_data_flow.png"/>
</div>
<h1><a class="anchor" id="autotoc_md63"></a>
Steps to run the application on J7 EVM (Linux + RTOS mode)</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a> for Linux+RTOS mode</li>
<li>Connect up to 8 D3-IMX390 RCM camera modules to cam0 - cam7 ports of the Fusion1 board.<ol type="a">
<li>For J784S4 + Fusion2 board, connect up to 12 D3-IMX390 RCM camera modules to cam0 - cam11 ports.</li>
<li>See <a href="../../../psdk_rtos/docs/user_guide/evm_setup_j784s4.html#fusion-daughter-card">Fusion1 Board setup </a></li>
<li>See <a href="../../../psdk_rtos/docs/user_guide/evm_setup_j784s4.html#fusion2-daughter-card">Fusion2 Board setup </a></li>
</ol>
</li>
<li>Use the is_interactive flag to run the demo in an interactive mode which allows the user to print performance characteristics on the UART console.</li>
<li>Run the app as shown below <div class="fragment"><div class="line">cd /opt/vision_apps</div><div class="line">source ./vision_apps_init.sh</div><div class="line">./run_app_multi_cam.sh</div></div><!-- fragment --></li>
<li>The processed output for one of the captured channel is displayed through DSS on HDMI or eDP display - Display interface selection through compile time setting in the file platform/j784s4/rtos/common/app_cfg_mcu2_0.h</li>
<li>See <a href="../datasheet/group_apps_basic_demos_app_multi_cam_8ch_datasheet.html">Vision Apps Datasheet </a> for performance of 8 camera system</li>
</ol>
<dl class="section note"><dt>Note</dt><dd><ol type="1">
<li><b> A single UB9702 deserializer (Fusion2) can handle 2x IMX728. To run 4x IMX728, 2x deserializers need to be used with 2x IMX728 on each deserializer. </b></li>
<li>To run multi-cam on non-sequential ports, run in non-interactive mode.<ol type="a">
<li>Modify <code>app_multi_cam.cfg</code> file in <code>/opt/vision_apps</code> to run IMX728 on ports 0, 1, 4, and 5: <div class="fragment"><div class="line"><span class="comment"># select IMX728</span></div><div class="line">sensor_index      4</div><div class="line"></div><div class="line"><span class="comment"># channel mask ports 0, 1, 4, and 5</span></div><div class="line">channel_mask      51</div><div class="line"></div><div class="line">num_frames_to_run  1000</div><div class="line"></div><div class="line"><span class="comment"># run in non-interactive mode</span></div><div class="line">is_interactive    0</div></div><!-- fragment --></li>
</ol>
</li>
<li>Save app_multi_cam.cfg file and run <code>./run_app_multi_cam.sh</code></li>
</ol>
</dd></dl>
<h1><a class="anchor" id="autotoc_md64"></a>
Steps to run the application on J7 EVM (QNX + RTOS mode)</h1>
<ol type="1">
<li>Build the application and related libraries as mentioned in <a class="el" href="BUILD_INSTRUCTIONS.html">Build Instructions</a> for QNX+RTOS mode</li>
<li>Connect up to 8 D3-IMX390 RCM camera modules to cam0 - cam7 ports of the Fusion1 board.<ol type="a">
<li>For J784S4 + Fusion2 board, connect up to 12 D3-IMX390 RCM camera modules to cam0 - cam11 ports.</li>
<li>See <a href="../../../psdk_rtos/docs/user_guide/evm_setup_j784s4.html#fusion-daughter-card">Fusion1 Board setup </a></li>
<li>See <a href="../../../psdk_rtos/docs/user_guide/evm_setup_j784s4.html#fusion2-daughter-card">Fusion2 Board setup </a></li>
</ol>
</li>
<li>Use the is_interactive flag to run the demo in an interactive mode which allows the user to print performance characteristics on the UART console.</li>
<li>In the case of J784S4, use the bypass_split_graph flag to determine whether or not to use both VPAC's available on J784S4. The split configuration mode splits the output from the capture node into 2 parallel pipelines running on each VPAC instance. The pipelines merge together in the mosaic node and are rendered onto the display using the display node. For other SoC's, this configuration is also enabled by default, but it will only execute on a single VPAC.</li>
<li>Run the app as shown below <div class="fragment"><div class="line">cd /ti_fs/vision_apps</div><div class="line">. ./vision_apps_init.sh</div><div class="line">./run_app_multi_cam.sh</div></div><!-- fragment --></li>
<li>The processed output for one of the captured channel is displayed through DSS on HDMI or eDP display - Display interface selection through compile time setting in the file platform/j784s4/rtos/common/app_cfg_mcu2_0.h</li>
<li>See <a href="../datasheet/group_apps_basic_demos_app_multi_cam_8ch_datasheet.html">Vision Apps Datasheet </a> for performance of 8 camera system </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
